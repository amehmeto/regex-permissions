{
  "_comment": [
    "Example regexPermissions config — place inside your .claude/settings.local.json",
    "Syntax mirrors native permissions: Tool(regex_pattern)",
    "Use object form { rule, reason, flags } when you need extras."
  ],

  "regexPermissions": {
    "deny": [
      { "rule": "Bash(^git\\s+(commit|push|merge|rebase)\\s+.*--no-verify)", "reason": "Never bypass git hooks" },
      { "rule": "Bash(^git\\s+push\\s+.*--force)", "reason": "No force push — use --force-with-lease" },
      { "rule": "Bash(^git\\s+(reset\\s+--hard|clean\\s+-f))", "reason": "Destructive git operations blocked" },
      { "rule": "Bash(^rm\\s+-rf\\s+(/|~|\\$HOME))", "reason": "Dangerous recursive delete" },
      { "rule": "Edit|Write(\\.env(\\.local|\\.production)?$)", "reason": "Do not modify environment secret files" },
      { "rule": "Bash(^(sudo|chmod\\s+777|chown))", "reason": "No privilege escalation" }
    ],

    "_note_on_overlap": "git push appears in both deny (--force) and ask (all pushes). Deny runs first, so --force is blocked; other pushes fall through to ask.",

    "ask": [
      { "rule": "Bash([;|&`$#])", "reason": "Shell metacharacters detected" },
      { "rule": "Bash(^git\\s+push)", "reason": "Confirm before pushing to remote" },
      { "rule": "Bash(^(npm|yarn|pnpm)\\s+(publish|unpublish))", "reason": "Publishing to registry requires approval" },
      { "rule": "Bash(^(docker|podman)\\s+(rm|rmi|system\\s+prune))", "reason": "Container cleanup requires approval" },
      { "rule": "Bash(^gh\\s+(pr|issue)\\s+(create|close|merge|comment|edit|delete|reopen))", "reason": "GitHub mutations require approval" },
      { "rule": "Bash(^aws\\s+\\S+\\s+(delete|remove|terminate|put|create|update|modify)-)", "reason": "AWS write operations require approval" }
    ],

    "allow": [
      "Bash(^\\S+\\s+--help$)",
      "Bash(^man\\s+)",

      "Bash(^git\\s+(status|log|diff|show|branch|tag|remote|stash\\s+list|ls-files|rev-parse|describe|shortlog|blame|reflog))",
      "Bash(^git\\s+(add|commit|stash\\s+(push|pop|apply|drop)))",
      "Bash(^git\\s+(checkout|switch|fetch|pull|rebase|merge|cherry-pick))",
      "Bash(^git\\s+(-C\\s+\\S+\\s+)?(grep|log|diff|show|status|blame)\\s)",

      "Bash(^gh\\s+(pr|issue|run|release|repo)\\s+(view|list|status|checks|diff))",
      "Bash(^gh\\s+api\\s+(-H\\s+\\S+\\s+)*repos/)",

      "Bash(^aws\\s+\\S+\\s+(get|list|describe|head)-)",
      "Bash(^aws\\s+sts\\s+get-caller-identity)",

      "Bash(^(npm|yarn|pnpm)\\s+(list|ls|info|view|outdated|audit|why|explain|pack\\s+--dry-run))",
      "Bash(^(npm|yarn|pnpm)\\s+(install|ci|add|remove|uninstall)\\b)",
      "Bash(^(npm|yarn|pnpm)\\s+run\\s+)",
      "Bash(^npx\\s+)",

      "Bash(^(node|ts-node|tsx)\\s+)",
      "Bash(^(jest|vitest|pytest|cargo\\s+test|go\\s+test|make\\s+test|npm\\s+test))",
      "Bash(^(tsc|esbuild|webpack|vite|rollup|next\\s+build|cargo\\s+build|go\\s+build|make)\\b)",
      "Bash(^(eslint|prettier|black|ruff|clippy|golint|rubocop))",

      "Bash(^(ls|pwd|which|whoami|date|uname|env|printenv|cat|head|tail|wc|sort|uniq|diff|file|stat|du|df|id|hostname)\\b)",
      "Bash(^(jq|yq)\\s+)",
      "Bash(^(curl|wget)\\s+)",

      "Bash(^(docker|podman)\\s+(ps|images|logs|inspect|stats|top|port|network\\s+ls|volume\\s+ls))",

      "Edit|Write|Read(\\.(ts|tsx|js|jsx|py|rs|go|java|rb|css|scss|html|json|yaml|yml|toml|md|txt|sh|sql|graphql|proto|xml|svg|vue|svelte)$)",

      "Glob|Grep(.*)",

      { "rule": "WebFetch((docs\\.|developer\\.|devdocs\\.|wiki\\.|man7\\.org|stackoverflow\\.com|github\\.com))", "flags": "i" },

      "WebSearch(.*)"
    ]
  }
}
